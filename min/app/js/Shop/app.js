var app_version="",_prelogin_key,md_id,fType="branch",nowPage,mCounty,mDistrict,regionIndex,zipArray,isNetwork=!0,loginType="",my_marker,scan_from,browser_width=$(window).width(),browser_height=$(window).height(),nowlat,nowlng,indexObj={_initDate:"2010/01/01 00:00:00",_dataUrl:{machine:"http://"+stringObj.MEMBER_URL+":"+stringObj.PORT+"/api/account/machineconnect",userdatacollect:"http://"+stringObj.APP_URL+":"+stringObj.PORT+"/account/userdatacollect",userbookmarkrecorver:"http://"+stringObj.WEB_URL+":"+stringObj.PORT+"/account/userbookmarkrecorver",userbookmarkupdate:"http://"+stringObj.WEB_URL+":"+stringObj.PORT+"/account/userbookmarkupdate",usermessagerecorver:"http://"+stringObj.APP_URL+":"+stringObj.PORT+"/account/usermessagerecorver",usermessageupdate:"http://"+stringObj.APP_URL+":"+stringObj.PORT+"/account/usermessageupdate",salesagentlogin:"http://"+stringObj.APP_URL+":"+stringObj.PORT+"/shop/salesagentlogin",verify_sat:"http://"+stringObj.MEMBER_URL+"/api/vrf/verify_sat",query_salt:"http://"+stringObj.MEMBER_URL+"/api/vrf/query_salt",querymembershopinfo:"http://"+stringObj.WEB_URL+"/shopmanage/querymembershopinfo",modify_member_data:"http://"+stringObj.WEB_URL+"/modify_member_data",post_member_introducer:"http://"+stringObj.APP_URL+"/system/post_member_introducer",verify_memberseccode:"http://"+stringObj.MEMBER_URL+":"+stringObj.PORT+"/api/vrf/verify_memberseccode",modify_memberseccode:"http://"+stringObj.MEMBER_URL+":"+stringObj.PORT+"/api/modify_memberseccode"},_storage:{main:_main,booking:"booking",branchData:"branchData",questionnaire:"questionnaire",questionLog:"questionLog",fbInfo:"fbInfo",userData:"userData",share:"share",favorite:"myFavorite",mailList:"mailList",newsIdList:"newsIdList",loginTimes:"loginTimes",fbLoginTimes:"fbLoginTimes",couponRecord:"couponRecord",shopCouponRecord:"shopCouponRecord",shopServiceRecord:"shopServiceRecord",businessIsLogin:"businessIsLogin",businessData:"businessData",binding:"binding",api_token:"api_token",myshopdata:"myshopdata",search_result:"search_result",reservationbook:"reservationbook"},listLoading:!1,listId:null,_templateSet:{},init:function(){var e=indexObj._dataCookies(indexObj._storage.main)||{};if(app_version=Cookies.get("app_version")||"",void 0===Cookies.get("app_version")&&void 0===e.murId?getMurId(function(e){setParameter(e)}):setParameter(e.murId),e.sat)indexObj.verify_sat(),md_id=e.mdId;else{if(md_id="Guest",loginType="",e&&e.murId){var t=e.murId,o=localStorage.getItem("salt_no"),i=localStorage.getItem("salt"),n=localStorage.getItem("listtype"),a=localStorage.getItem("cate");if(localStorage.getItem(indexObj._storage.search_result))var r=localStorage.getItem(indexObj._storage.search_result);if(localStorage.getItem("pageInit"))var s=localStorage.getItem("pageInit");localStorage.clear(),Cookies.remove("branchData"),indexObj._dataCookies(indexObj._storage.main,{murId:t},"iscarmg.com"),localStorage.setItem("salt_no",o),localStorage.setItem("salt",i),localStorage.setItem("listtype",n),localStorage.setItem("cate",a),localStorage.setItem(indexObj._storage.search_result,r),localStorage.setItem("pageInit",s)}void 0===nowPage&&("false"!==localStorage.getItem("pageInit")?mainView.router.load({url:localStorage.getItem("pageInit"),reload:!0}):window.location="pm/branch-cooperative?cate="+branch_cate+"&listtype="+nowBranchType),localStorage.removeItem("pageInit")}e.mdId&&branchObj.favoriteUpdate()},jsonUrlDecode:function(e){for(var t in e)"object"==typeof e[t]?this.jsonUrlDecode(e[t]):e[t]=decodeURIComponent(e[t])},jsonUrlEncode:function(e){for(var t in e)"object"==typeof e[t]?this.jsonUrlEncode(e[t]):e[t]=encodeURIComponent(e[t])},_wcfget:function(e){var t=e.url,o=JSON.stringify(JSON.stringify(e.para));$$.ajax({contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",url:t,data:o,success:function(t){e.success&&e.success(t)},error:function(t){e.error&&e.error(t)},complete:function(t){e.finish&&e.finish(t)},beforeSend:function(t){e.progress&&e.progress(t)}})},_dataStorage:function(e,t){return void 0===t?"undefined"!==localStorage.getItem(e)?JSON.parse(localStorage.getItem(e)):"":null===t?(localStorage.removeItem(e),!0):"object"==typeof t&&(localStorage.setItem(e,JSON.stringify(t)),!0)},_dataCookies:function(e,t,o){return void 0===t?void 0!==Cookies.get(e)&&JSON.parse(Cookies.get(e)):null===t?(Cookies.remove(e),!0):"object"==typeof t?(void 0===o?Cookies.set(e,JSON.stringify(t)):Cookies.set(e,JSON.stringify(t),{domain:o}),!0):"string"==typeof t&&(void 0===o?Cookies.set(e,t):Cookies.set(e,t,{domain:o}),!0)},template:function(e){if(e in indexObj._templateSet)return indexObj._templateSet[e];var t=$$("#"+e).length?$$("#"+e).html():"",o=Template7.compile(t);return indexObj._templateSet[e]=o,indexObj._templateSet[e]},bonusInquireInit:function(e){var t=indexObj._dataCookies(indexObj._storage.main),o={modacc:stringObj.shop.moduleaccount,modvrf:Cookies.get("modvrf"),sat:t.sat};indexObj._wcfget({url:indexObj._dataUrl.coininfoquery,para:o,success:function(e){if(blogObj.jsonUrlDecode(e),e.coininfoqueryresult){var t=JSON.parse(JSON.stringify(e.coininfoqueryresult));if("000000000"===t.message_no){var o={};o.cos_end_coin=t.cos_end_coin||"0",o.cos_end_giftpoint=t.cos_end_giftpoint||"0",o.factorybonus=[];var i={};for(var n in t.factorybonus){var a=JSON.parse(localStorage.getItem("fd_"+t.factorybonus[n].fd_id));i.fd_cname=a.fd_cname,i.cos_end_fdbonus=t.factorybonus[n].cos_end_fdbonus,o.factorybonus.push(i)}var r=indexObj.template("templateWallet")(o);$$(".bonusInquireBlock").html(r),myApp.initImagesLazyLoad(".page-content");var s={useEasing:!0,useGrouping:!0,separator:",",decimal:".",prefix:"",suffix:""};new CountUp("#coin-num",0,parseInt(t.cos_end_coin),0,1,s).start(),new CountUp("#count-num",0,parseInt(t.cos_end_giftpoint),0,1,s).start()}else stringObj.return_header(t.message_no),_tip&&(myApp.alert(_tip+"( "+t.message_no+" )",stringObj.text.warn),_tip=null);myApp.hidePreloader()}},error:function(e){}})},shopMenuInit:function(e){var t=indexObj._dataCookies(indexObj._storage.main)||{};"1"===t.md_clienttype?(stringObj.shop.isShop=!0,$(".left a").attr("href","shop/branch-main")):(stringObj.shop.isShop=!1,$(".left a").attr("href","branch-cooperative")),t.sat&&(stringObj.shop.signed_in=!0);var o=indexObj.template("templateShopMenu")(stringObj.shop);$$(".contentBlock").html(o)},couponRecordInit:function(e){var t=e.query;if(t.tab){myApp.showTab("#"+t.tab);i=(o=indexObj.template("templateCouponRecordList"))("");$$("#"+t.tab+" .content-block").html(i),"shop-coupon"==t.tab?branchObj.shopcouponrecorver():"queue"==t.tab&&branchObj.shopservicequerecorver(),myApp.accordionOpen(".available-block")}else{var o=indexObj.template("templateCouponRecordList"),i=o("");$$("#queue .content-block").html(i),branchObj.shopservicequerecorver(),myApp.accordionOpen(".available-block")}$$("#shop-coupon").on("show",function(){var e=indexObj.template("templateCouponRecordList")("");$$("#shop-coupon .content-block").html(e),branchObj.shopcouponrecorver(),myApp.accordionOpen(".available-block")}),$$("#queue").on("show",function(){var e=indexObj.template("templateCouponRecordList")("");$$("#queue .content-block").html(e),branchObj.shopservicequerecorver(),myApp.accordionOpen(".available-block")}),$$(".available-block").on("opened",function(){isMobile.Android()?webview.nowEvent("Qrmenu-And","useable",md_id):isMobile.iOS()&&webview.nowEvent("Qrmenu-iOS","useable",md_id)}),$$(".finish-block").on("opened",function(){isMobile.Android()?webview.nowEvent("Qrmenu-And","used",md_id):isMobile.iOS()&&webview.nowEvent("Qrmenu-iOS","used",md_id)}),$$(".invalid-block").on("opened",function(){isMobile.Android()?webview.nowEvent("Qrmenu-And","expire",md_id):isMobile.iOS()&&webview.nowEvent("Qrmenu-iOS","expire",md_id)}),window.intervalParam=window.setInterval(function(){myApp.initImagesLazyLoad(".page-content")},2e3)},_userLogout:function(){var e=indexObj._dataCookies(indexObj._storage.main)||{};window.location="http://"+stringObj.MEMBER_URL+"/logout?parameter="+Cookies.get("parameter")+"&sat="+e.sat},querymembershopinfo:function(){if(myApp.showIndicator(),!indexObj.listLoading){indexObj.listLoading=!0;var e=indexObj._dataCookies(indexObj._storage.main)||{},t={modacc:stringObj.shop.moduleaccount,modvrf:Cookies.get("modvrf"),sat:e.sat,queryamount:20,sd_id:indexObj.listId};indexObj._wcfget({url:indexObj._dataUrl.querymembershopinfo,para:t,success:function(t){if(myApp.hideIndicator(),indexObj.jsonUrlDecode(t),t.querymembershopinforesult){var o=JSON.parse(JSON.stringify(t.querymembershopinforesult));if("000000000"===o.message_no){var i=indexObj._dataStorage(indexObj._storage.myshopdata)||[];if("myBranchs"===nowPage){for(var n in o.shopdata_array)o.shopdata_array[n].sd_shopphotopath?o.shopdata_array[n].sd_shopphotopath=stringObj.text.branch_img_path+o.shopdata_array[n].sd_shopphotopath:o.shopdata_array[n].sd_shopphotopath="../app/image/imgDefault.png",i.push(o.shopdata_array[n]),indexObj._dataStorage(indexObj._storage.myshopdata,i);o.shopdata_array.length>0&&(indexObj.listId=o.shopdata_array[o.shopdata_array.length-1].sd_id);var a=indexObj.template("templateMyBranchs")(o);$$(".myBranchsList").append(a),myApp.initImagesLazyLoad(".page-content"),$$(".infinite-scroll-preloader").hide(),indexObj.listLoading=!1;var r=indexObj._dataStorage(indexObj._storage.branchData)||{};r.sd_id?($(".myBranchs-left").css("visibility","visible"),$(".myBranchs-right").css("visibility","visible"),$(".floating-button").css("display","flex"),$(".item-"+r.sd_id).css("background","rgba(80, 80, 80, .6)"),$(".item-"+r.sd_id).css("color","#fff"),$(".open-store").click(function(){if(e.sat){var t=indexObj._dataStorage(branchObj.storage.applicationData)||"";t?(myApp.modal({title:stringObj.text.application_data_record,text:'<div class="row"><div class="col-28">店名：</div><div class="col-72">'+t.sd_shopname+'</div></div><div class="row"><div class="col-28">狀態：</div><div class="col-72">'+stringObj.text.not_finish+"</div></div>",buttons:[{text:stringObj.text._delete,onClick:function(){indexObj._dataStorage(branchObj.storage.applicationData,null)}},{text:stringObj.text._continue,onClick:function(){"0"==t.operation_type?mainView.router.load({url:"application-shop",reload:!0}):"1"==t.operation_type&&mainView.router.load({url:"application-usedcar",reload:!0})}}]}),$(".modal-title + .modal-text").css("text-align","left"),$(".modal-title + .modal-text").css("margin","5% 3%"),$(".modal-title + .modal-text .row").css("margin","3% 0"),$(".modal-title + .modal-text .row .col-28").css("width","28%"),$(".modal-title + .modal-text .row .col-28").css("color","darkslategray"),$(".modal-title + .modal-text .row .col-72").css("width","72%")):mainView.router.load({url:"application-shop"})}else myApp.modal({title:stringObj.text.warn,text:stringObj.text.notLogin,buttons:[{text:stringObj.text.cancel,onClick:function(){}},{text:stringObj.text.login,onClick:function(){webview.loginPage()}}]})})):($(".myBranchs-right").css("visibility","visible"),$(".floating-button").css("display","none"))}else indexObj.init()}else indexObj.init(),myApp.detachInfiniteScroll($$(".infinite-scroll")),$$(".infinite-scroll-preloader").remove(),stringObj.return_header(o.message_no),_tip&&(myApp.alert(_tip+"( "+o.message_no+" )",stringObj.text.warn),_tip=null)}},error:function(e){myApp.detachInfiniteScroll($$(".infinite-scroll")),$$(".infinite-scroll-preloader").remove(),myApp.hideIndicator()}})}},modify_member_data:function(e){var t={modacc:stringObj.shop.moduleaccount,modvrf:Cookies.get("modvrf"),sat:e.sat,md_id:e.mdId,md_cname:e.md_cname,md_picturepath:e.md_picturepath,md_logintype:e.loginType,md_clienttype:e.md_clienttype,md_clubjoinstatus:e.md_clubjoinstatus,md_city:e.md_city,rl_city_code:e.rl_city_code,rl_zip:e.rl_zip,md_country:e.md_country,md_birthday:e.md_birthday,md_fbgender:e.md_fbgender};indexObj._wcfget({url:indexObj._dataUrl.modify_member_data,para:t,success:function(e){if(indexObj.jsonUrlDecode(e),e.modify_member_dataresult){var t=JSON.parse(JSON.stringify(e.modify_member_dataresult));"000000000"===t.message_no||(stringObj.return_header(t.message_no),_tip&&(myApp.alert(_tip+"( "+t.message_no+" )",stringObj.text.warn),_tip=null))}},error:function(e){}})},query_salt:function(e,t){myApp.showIndicator();var o={modacc:e};indexObj._wcfget({url:indexObj._dataUrl.query_salt,para:o,success:function(o){if(indexObj.jsonUrlDecode(o),o.query_saltresult){var i=JSON.parse(JSON.stringify(o.query_saltresult));if("000000000"===i.message_no){var n=atob(decodeURIComponent(i.salt)),a=n.substring(0,n.indexOf("_")),r=n.substring(n.indexOf("_")+1);Cookies.set("salt_no",a),Cookies.set("salt",r),Cookies.set("modvrf",encodeURIComponent(btoa(a+"_"+CryptoJS.SHA256(e+t+r)))),localStorage.setItem("salt_no",a),localStorage.setItem("salt",r),loginInit(function(e){e.mdId?(myApp.hideIndicator(),indexObj.modify_member_data(e),"1"===e.md_clienttype?indexObj.querymembershopinfo():indexObj.init()):(myApp.hideIndicator(),indexObj.init())})}else stringObj.return_header(i.message_no),_tip&&(myApp.alert(_tip+"( "+i.message_no+" )",stringObj.text.warn),_tip=null)}},error:function(e){myApp.hideIndicator()}})},verify_sat:function(){myApp.showIndicator();var e=indexObj._dataCookies(indexObj._storage.main)||{},t={modacc:stringObj.shop.moduleaccount,modvrf:Cookies.get("modvrf"),sat:e.sat};indexObj._wcfget({url:indexObj._dataUrl.verify_sat,para:t,success:function(e){if(myApp.hideIndicator(),indexObj.jsonUrlDecode(e),e.verify_satresult){var t=JSON.parse(JSON.stringify(e.verify_satresult));if("010110001"===t.message_no){var o,n,a=indexObj._dataCookies(indexObj._storage.main)||{},r=location.search,s=[];if(-1!=r.indexOf("sd_id")){for(o=(c=r.split("?"))[1].split("&"),i=0;i<o.length;i++)n=o[i].split("="),s.push(n[1]);window.location="pm/branch-info?sd_id="+s[0]}else if(-1!=r.indexOf("scm_id")){var c=r.split("?");for(o=c[1].split("&"),i=0;i<o.length;i++)n=o[i].split("="),s.push(n[1]);window.location="pm/shopcoupon-info?scm_id="+s[0]}else if(-1!=r.indexOf("upload_back"))mainView.router.load({url:localStorage.getItem("back_url").substring(localStorage.getItem("back_url").indexOf("#!/")+3)}),localStorage.removeItem("back_url");else{if(void 0===nowPage)if(null===localStorage.getItem("scg_id")&&null===localStorage.getItem("pageInit"))if("1"==a.md_clienttype||"2"==a.md_clienttype){var d=indexObj._dataStorage(branchObj.storage.branchData)||{},l=indexObj._dataStorage(indexObj._storage.myshopdata)||"";JSON.stringify(l).match(d.sd_id)&&"shop"===d.sd_type?mainView.router.load({url:"shop/branch-main?sd_id="+d.sd_id}):(indexObj._dataStorage(branchObj.storage.branchData,null),mainView.router.load({url:"shop/myBranchs",reload:!0}))}else indexObj._dataStorage(branchObj.storage.branchData,null),window.location="pm/branch-cooperative?cate="+branch_cate+"&listtype="+nowBranchType;else"false"!==localStorage.getItem("pageInit")&&mainView.router.load({url:localStorage.getItem("pageInit"),reload:!0});localStorage.removeItem("pageInit")}}else{if(window.location="pm/branch-cooperative?cate="+branch_cate+"&listtype="+nowBranchType,indexObj._dataStorage(indexObj._storage.branchData,null),indexObj._dataStorage(indexObj._storage.favorite,null),indexObj._dataStorage(indexObj._storage.mailList,null),indexObj._dataStorage(indexObj._storage.couponRecord,null),indexObj._dataStorage(indexObj._storage.shopCouponRecord,null),indexObj._dataStorage(indexObj._storage.shopServiceRecord,null),loginType="",(a=indexObj._dataCookies(indexObj._storage.main)||{})&&a.murId){if("0"===a.loginType)a.sso_token;indexObj._dataCookies(indexObj._storage.main,{murId:a.murId},"iscarmg.com")}stringObj.return_header(t.message_no),_tip&&(myApp.alert(_tip+"( "+t.message_no+" )",stringObj.text.warn),_tip=null),userAvatarInit()}}},error:function(e){myApp.hideIndicator()}})},modify_memberseccode:function(e,t){myApp.showIndicator();var o=indexObj._dataCookies(indexObj._storage.main)||{},i={modacc:stringObj.shop.moduleaccount,modvrf:Cookies.get("modvrf"),md_id:o.mdId,old_md_securitycode:e,new_md_securitycode:t};e||(i.old_md_securitycode=""),indexObj._wcfget({url:indexObj._dataUrl.modify_memberseccode,para:i,success:function(e){if(myApp.hideIndicator(),indexObj.jsonUrlDecode(e),e.modify_memberseccoderesult){var t=JSON.parse(JSON.stringify(e.modify_memberseccoderesult));if("000000000"===t.message_no){var o=indexObj._dataCookies(indexObj._storage.main)||{};o.md_seccode_created="1",Cookies.set(indexObj._storage.main,JSON.stringify(o),{domain:"iscarmg.com"}),myApp.toast(stringObj.text.settingFinish,"",{}).show(),myApp.closeModal()}else stringObj.return_header(t.message_no),_tip&&(myApp.alert(_tip+"( "+t.message_no+" )",stringObj.text.warn),_tip=null)}},error:function(e){myApp.hideIndicator()}})},verify_memberseccode:function(e){myApp.showIndicator();var t=indexObj._dataCookies(indexObj._storage.main)||{},o={modacc:stringObj.shop.moduleaccount,modvrf:Cookies.get("modvrf"),md_id:t.mdId,md_securitycode:e};indexObj._wcfget({url:indexObj._dataUrl.verify_memberseccode,para:o,success:function(t){if(myApp.hideIndicator(),indexObj.jsonUrlDecode(t),t.verify_memberseccoderesult){var o=JSON.parse(JSON.stringify(t.verify_memberseccoderesult));if("000000000"===o.message_no)switch(myApp.closeModal(),nowPage){case"pay-info":if(void 0===Cookies.get("createpaymentflow")){var i=indexObj._dataStorage("logistics_data")||{},n=indexObj._dataStorage("shop_item")||{};branchObj.shopCouponGet(n.scm_id,i.from,e)}else indexObj._dataStorage(indexObj._storage.reservationbook,null),localStorage.removeItem("scg_id"),localStorage.removeItem("scm_id"),indexObj._dataStorage("shop_item",null),indexObj._dataStorage("shop_buy_data",null),indexObj._dataStorage("logistics_data",null),myApp.modal({title:stringObj.text.warn,text:stringObj.text.repay_context,buttons:[{text:stringObj.text.cancel,onClick:function(){window.location="pm/branch-cooperative?cate="+branch_cate+"&listtype="+nowBranchType}},{text:stringObj.text.goto,onClick:function(){window.location="http://"+stringObj.APP_URL+"/ShoppingRecord?from=pay_info"}}]});break;case"application-shop":var a='<div class="popup authorization-popup"><div class="content-block"><div class="title">'+stringObj.shop_cooperation_agreement_title+'</div><div class="authorization-content"><div class="main_content_text">'+stringObj.shop_cooperation_agreement+'</div><div class="row btns"><div class="col-45 refuse close-popup">'+stringObj.text.refuse+'</div><div class="col-10"></div><div class="col-45 agree close-popup">'+stringObj.text.agree+"</div></div></div></div></div>";myApp.popup(a),$(".authorization-popup .sd_shopname").html($("#shop_name").val()),$(".agree").click(function(t){var o=indexObj._dataCookies("postshopdata")||{};o.md_securitycode=e,branchObj.postshopdata(o),indexObj._dataCookies("postshopdata",null)});break;case"shopcoupon-management":var r=indexObj._dataCookies("shopcouponmanager_data")||{};"0"===r.scm_poststatus?(r.md_securitycode=e,branchObj.shopcouponmanager(r),indexObj._dataCookies("shopcouponmanager_data",null)):"1"===r.scm_poststatus&&(myApp.modal({title:stringObj.shop.authorization_title,text:stringObj.shop.agree_tips+'<br><input id="shopcouponcheck" type="checkbox" style="width: 15px;height: 15px;"> 我同意',buttons:[{text:stringObj.text.send_to,onClick:function(){$("#shopcouponcheck").prop("checked")?(r.md_securitycode=e,branchObj.shopcouponmanager(r),indexObj._dataCookies("shopcouponmanager_data",null)):myApp.toast(stringObj.text.disagree,"",{}).show()}}]}),$(".agree_tips_context").css("text-align","left"))}else stringObj.return_header(o.message_no),_tip&&(myApp.alert(_tip+"( "+o.message_no+" )",stringObj.text.warn),_tip=null)}},error:function(e){myApp.hideIndicator()}})},post_member_introducer:function(e,t,o){myApp.showIndicator();var i=indexObj._dataCookies(indexObj._storage.main)||{},n={modacc:stringObj.shop.moduleaccount,modvrf:Cookies.get("modvrf"),sat:i.sat,introducer_type:e,introducer_id:t,bindobject_id:o};indexObj._wcfget({url:indexObj._dataUrl.post_member_introducer,para:n,success:function(e){if(myApp.hideIndicator(),indexObj.jsonUrlDecode(e),e.post_member_introducerresult){var t=JSON.parse(JSON.stringify(e.post_member_introducerresult));"000000000"===t.message_no?myApp.alert(stringObj.text.introduce_completed,stringObj.text.warn):(stringObj.return_header(t.message_no),_tip&&(myApp.alert(_tip+"( "+t.message_no+" )",stringObj.text.warn),_tip=null))}},error:function(e){myApp.hideIndicator()}})}};findAndRemove=function(e,t,o){e.forEach(function(i,n){i[t]===o&&e.splice(n,1)})},findArrayItem=function(e,t,o){e.forEach(function(e,i){e[t]===o&&(nowIndex=i)})},hrefTo=function(e){mainView.router.load({url:e})},iOnJSHTMLUpdate=function(e){if(isMobile.iOS()){var t=jQuery.parseJSON(e);myApp.modal({title:stringObj.text.warn,text:stringObj.text.iosWebUpdateContext,buttons:[{text:stringObj.text.confirm,onClick:function(){iPhone.ConfirmJSHTMLUpdate(t.version,t.url)}}]})}},getVersionName=function(e){app_version=e,Cookies.set("app_version",app_version),$$(".versionName").html(e)},StartQR=function(){isMobile.iOS()&&iPhone.StartQR()},setQRCode=function(e){isMobile.iOS()&&myApp.alert(e,"QR Code")},noNetwork=function(){toast.show(stringObj.text.noNetwork),$(".toast-container").css("color","#F26531"),$(".toast-container").css("top","50%"),$(".toast-container").css("left","45%"),$(".toast-container").css("background-color","rgba(30,30,30,.85)"),browser_width<992?$(".toast-container").css("width","40%"):$(".toast-container").css("width","18%")},scan=function(e){scan_from=e;var t=localStorage.getItem(indexObj._storage.businessIsLogin);(indexObj._dataCookies(indexObj._storage.main)||{}).sat?isMobile.Android()&&"business"==e&&"Yes"==t?Android.qrScan():isMobile.iOS()&&"business"==e&&"Yes"==t?iPhone.StartQR():isMobile.Android()&&"branch"==e?Android.qrScan():isMobile.iOS()&&"branch"==e?iPhone.StartQR():isMobile.Android()&&"add-staff"===e?Android.qrScan():isMobile.iOS()&&"add-staff"==e?iPhone.StartQR():webview.scan():myApp.modal({title:stringObj.text.warn,text:stringObj.text.notLogin,buttons:[{text:stringObj.text.cancel,onClick:function(){}},{text:stringObj.text.login,onClick:function(){webview.loginPage()}}]})},getMessage=function(){var e=indexObj._dataCookies(indexObj._storage.main)||{};window.location="http://"+stringObj.WEB_URL+"/Mailbox/www/transform?user_info="+encodeURIComponent(JSON.stringify(e))},getAlarmMessage=function(e){var t=indexObj._dataCookies(indexObj._storage.main)||{};if(e.match("crn_id")){var o=indexObj._dataStorage(usedCarObj.storage.reservationRecord);findArrayItem(o.availableList,"crn_id",e.substring(6)),"0"==t.md_clienttype?startPage="used-car/reservation-info?crn_id="+e.substring(6)+"&cbi_id="+o.availableList[nowIndex].cbi_id+"&from=record-c":"1"==t.md_clienttype&&(startPage="used-car/reservation-info?crn_id="+e.substring(6)+"&cbi_id="+o.availableList[nowIndex].cbi_id+"&from=record-b")}else{var i=indexObj._dataStorage(indexObj._storage.couponRecord);findArrayItem(i.availableList,"cdd_qr",e),startPage="coupon-content?cdmId="+i.availableList[nowIndex].cdm_id+'&type="available"&cdd_qr='+e}},onRestart=function(){var e=indexObj._dataCookies(indexObj._storage.main)||{};e.sat&&(window.location="http://"+stringObj.APP_URL+"/Mailbox/transform?user_info="+encodeURIComponent(JSON.stringify(e)))},sortByProperty=function(e,t){return function(o,i){return o[e]>i[e]&&1===t?1:o[e]<i[e]&&-1===t?1:o[e]==i[e]?0:-1}},bindingCheck=function(e){switch($$(".panel-right nav li").removeClass("active"),$$(".panel-right nav li .item-title").each(function(e,t){$$(t).text()==stringObj.menu.fbBinding&&$$(t).parents("li").addClass("active")}),e){case"facebook":myApp.modal({title:stringObj.text.warn,text:stringObj.text.fbBindingContext,buttons:[{text:stringObj.text.cancel,onClick:function(){}},{text:stringObj.text.binding,onClick:function(){fbEvent="binding",webview.fbLogin()}}]})}},scanMsg=function(e){if("invitejoinclub"==scan_from)if(e.match("member_card_id")){var t=JSON.parse(e),o=indexObj._dataCookies(indexObj._storage.main),i={modacc:stringObj.shop.moduleaccount,modvrf:Cookies.get("modvrf"),sat:o.sat,ccd_id:o.clubdata.ccd_id,invitee_id:t.member_card_id};carClubObj.invitejoinclub(i)}else myApp.toast(stringObj.text.scan_msg_error,"",{}).show(),$(".toast-container").css("width","40%"),$(".toast-container").css("left","45%");else if(e.match("member_card_id"))switch(scan_from){case"branch":t=JSON.parse(e);myApp.modal({title:stringObj.text.warn,text:stringObj.shop.addClient,buttons:[{text:stringObj.text.cancel,onClick:function(){}},{text:stringObj.text.confirm,onClick:function(){var e=indexObj._dataStorage(branchObj.storage.branchData)||{};indexObj.post_member_introducer(1,e.sd_id,t.member_card_id)}}]});break;case"business":var n=(t=JSON.parse(e)).member_card_id;mainView.router.load({url:"branch-binding?md_id="+n});break;case"add-staff":t=JSON.parse(e);branchObj.querymemberidinfo(t.member_card_id)}else if("report"===scan_from){a=JSON.parse(e);branchObj.querysclid(a.scl_id)}else if(e.match("scg_id")){a=JSON.parse(e);branchObj.shopcouponscan(a.scm_id,a.scg_id)}else if(e.match("ssqd_id")){var a=JSON.parse(e);branchObj.shopservicescan(a.ssqd_id,a.ssqq_id,a.ssqq_queserno)}else if(e.match("cdm_id"))mainView.router.load({url:"scan-info?msg="+e});else if(e.match("temple_donate"))switch((a=JSON.parse(e)).temple_name){case"行天宮":mainView.router.load({url:"temple-info-1?from=scan&tp_id=1"});break;case"大甲鎮瀾宮":mainView.router.load({url:"temple-info-2?from=scan&tp_id=2"});break;case"鹿港天后宮":mainView.router.load({url:"temple-info-3?from=scan&tp_id=3"})}else myApp.toast(stringObj.text.scan_msg_error,"",{}).show(),$(".toast-container").css("width","40%"),$(".toast-container").css("left","45%")},addFavorite=function(e,t,o,i,n,a,r){if(indexObj.jsonUrlDecode(o),void 0!==(indexObj._dataCookies(indexObj._storage.main)||{}).sat){var s,c=indexObj._dataStorage(indexObj._storage.favorite)||{lastupdate:"",newsList:[],couponList:[],branchList:[],shopcouponList:[]};switch(r){case"0":s=JSON.stringify(c.newsList);break;case"1":s=JSON.stringify(c.couponList);break;case"2":s=JSON.stringify(c.branchList);break;case"3":s=JSON.stringify(c.shopcouponList)}if(s.match(e))myApp.modal({title:stringObj.text.warn,text:stringObj.text.marksRemoveCheck,buttons:[{text:stringObj.text.cancel},{text:stringObj.text.confirm,onClick:function(){$(".favorite-"+e).removeClass("expandOpen");var t=indexObj._dataCookies(indexObj._storage.main),o={modacc:stringObj.shop.moduleaccount,modvrf:Cookies.get("modvrf"),sat:t.sat,useroperate:"1",ubm_objecttype:r,ubm_objectid:e};myApp.showIndicator(),indexObj._wcfget({url:indexObj._dataUrl.userbookmarkupdate,para:o,success:function(t){if(t.userbookmarkupdateresult){var o=JSON.parse(JSON.stringify(t.userbookmarkupdateresult));"000000000"===o.message_no?("0"===r?(findAndRemove(c.newsList,"ubm_objectid",e),isMobile.Android()?webview.nowEvent("nsdelmark-And",e,md_id):isMobile.iOS()&&webview.nowEvent("nsdelmark-iOS",e,md_id)):"1"===r?(findAndRemove(c.couponList,"ubm_objectid",e),isMobile.Android()?webview.nowEvent("cpdelmark-And",e,md_id):isMobile.iOS()&&webview.nowEvent("cpdelmark-iOS",e,md_id)):"2"===r?findAndRemove(c.branchList,"ubm_objectid",e):"3"===r&&findAndRemove(c.shopcouponList,"ubm_objectid",e),"post"===nowPage||"favorite-post"===nowPage||"mail-post"===nowPage?($$(".favorite-"+e+" span").html('<i class="fa fa-star-o"></i>'),$$(".favorite-"+e+" span").css("color","#fff")):"branch-cooperative"===nowPage||"branch-info"===nowPage||"shop-search-result"===nowPage||"around-search-result"===nowPage?(myApp.alert(stringObj.text.nowCoin+"："+o.gpmr_point,stringObj.text.warn),$$(".favorite-"+e).html('<img src="../app/image/unsubscribe.png" onerror=\'this.src="app/image/imgDefault.png"\' />')):$$(".favorite-"+e).html('<i class="fa fa-star-o"></i>'),indexObj._dataStorage(indexObj._storage.favorite,c)):(stringObj.return_header(o.message_no),_tip&&(myApp.alert(_tip+"( "+o.message_no+" )",stringObj.text.warn),_tip=null)),myApp.hideIndicator()}},error:function(e){myApp.hideIndicator(),noNetwork()}})}}]});else switch(r){case"2":myApp.modal({title:stringObj.text.warn,text:stringObj.shop.iscarpolicy,buttons:[{text:stringObj.text.refuse,onClick:function(){}},{text:stringObj.text.agree,onClick:function(){addBookmarks(e,t,o,i,n,a,r)}}]}),$(".modal .query_iscarpolicy").click(function(){var e='<div class="popup popup-iscarpolicy"><div class="close-btn"><a href="#" class="close-popup"><i class="fa fa-times" aria-hidden="true"></i></a></div><div class="content-block"><div class="title">『就是行』汽車特店會員服務條款</div><div class="iscarpolicy-content"><div class="main_content_text">'+stringObj.shop_service_contract+"</div></div></div></div>";myApp.popup(e),$(".popup-iscarpolicy").css("z-index","91000")});break;default:addBookmarks(e,t,o,i,n,a,r)}}else myApp.modal({title:stringObj.text.warn,text:stringObj.text.notLogin,buttons:[{text:stringObj.text.cancel,onClick:function(){}},{text:stringObj.text.login,onClick:function(){webview.loginPage()}}]})},addBookmarks=function(e,t,o,i,n,a,r){var s=indexObj._dataCookies(indexObj._storage.main)||{},c={modacc:stringObj.shop.moduleaccount,modvrf:Cookies.get("modvrf"),sat:s.sat,useroperate:"0",ubm_objecttype:r,ubm_objectid:e};myApp.showIndicator(),indexObj._wcfget({url:indexObj._dataUrl.userbookmarkupdate,para:c,success:function(s){if(s.userbookmarkupdateresult){var c=JSON.parse(JSON.stringify(s.userbookmarkupdateresult));if("000000000"===c.message_no||"011601002"===c.message_no){"post"===nowPage||"favorite-post"===nowPage||"mail-post"===nowPage?($$(".favorite-"+e+" span").html('<i class="fa fa-star"></i>'),$$(".favorite-"+e+" span").css("color","#FFFF3B")):"branch-cooperative"===nowPage||"branch-info"===nowPage||"shop-search-result"===nowPage||"around-search-result"===nowPage?("000000000"===c.message_no?myApp.alert(stringObj.text.nowCoin+"："+c.gpmr_point,stringObj.text.subscription_success):(stringObj.return_header(c.message_no),_tip&&(myApp.alert(_tip,stringObj.text.subscription_success),_tip=null)),$(".favorite-"+e).addClass("expandOpen"),$(".favorite-"+e).html('<img src="../app/image/subscribe.png" onerror=\'this.src="app/image/imgDefault.png"\' />')):($(".favorite-"+e).addClass("expandOpen"),$$(".favorite-"+e).html('<i class="fa fa-star"></i>'));var d=indexObj._dataStorage(indexObj._storage.favorite)||{lastupdate:"",newsList:[],couponList:[],branchList:[],shopcouponList:[]},l={};l.ubm_objectid=e,l.ubm_picpath=t,l.ubm_title=o,l.catName=i,l.author=n,l.create_date="3"===r?a:a.substring(0,10),l.isflag="1",l.date=new Date(a)/864e5,"0"===r?(d.newsList.push(l),isMobile.Android()?webview.nowEvent("nsaddmark-And",e,md_id):isMobile.iOS()&&webview.nowEvent("nsaddmark-iOS",e,md_id)):"1"===r?(d.couponList.push(l),isMobile.Android()?webview.nowEvent("cpaddmark-And",e,md_id):isMobile.iOS()&&webview.nowEvent("cpaddmark-iOS",e,md_id)):"2"===r?d.branchList.push(l):"3"===r&&d.shopcouponList.push(l),indexObj._dataStorage(indexObj._storage.favorite,d)}else stringObj.return_header(c.message_no),_tip&&(myApp.alert(_tip+"( "+c.message_no+" )",stringObj.text.warn),_tip=null);myApp.hideIndicator()}},error:function(e){myApp.hideIndicator(),noNetwork()}})},removeFavorite=function(e,t){$$(".swipeout-"+e).on("deleted",function(){var o=indexObj._dataStorage(indexObj._storage.favorite),i=indexObj._dataCookies(indexObj._storage.main),n={modacc:stringObj.shop.moduleaccount,modvrf:Cookies.get("modvrf"),sat:i.sat,useroperate:"1",ubm_objecttype:t,ubm_objectid:e};myApp.showIndicator(),indexObj._wcfget({url:indexObj._dataUrl.userbookmarkupdate,para:n,success:function(i){if(i.userbookmarkupdateresult){var n=JSON.parse(JSON.stringify(i.userbookmarkupdateresult));if("000000000"===n.message_no){if("0"===t?(findAndRemove(o.newsList,"ubm_objectid",e),isMobile.Android()?webview.nowEvent("nsdelmark-And",e,md_id):isMobile.iOS()&&webview.nowEvent("nsdelmark-iOS",e,md_id)):"1"===t?(findAndRemove(o.couponList,"ubm_objectid",e),isMobile.Android()?webview.nowEvent("cpdelmark-And",e,md_id):isMobile.iOS()&&webview.nowEvent("cpdelmark-iOS",e,md_id)):findAndRemove(o.branchList,"ubm_objectid",e),"post"===nowPage||"favorite-post"===nowPage||"mail-post"===nowPage?($$(".favorite-"+e+" span").html('<i class="fa fa-star-o"></i>'),$$(".favorite-"+e+" span").css("color","#fff")):"branch-info"===nowPage?($$(".track a").html("追蹤"),$$(".track a").css("background-color","#F26531")):"branch-cooperative"===nowPage||"branch-info"===nowPage||"shop-search-result"===nowPage||"around-search-result"===nowPage?(myApp.alert(stringObj.text.nowCoin+"："+n.gpmr_point,stringObj.text.warn),$$(".favorite-"+e).html('<img src="../app/image/unsubscribe.png" onerror=\'this.src="app/image/imgDefault.png"\' />')):$$(".favorite-"+e).html('<i class="fa fa-star-o"></i>'),"favorite"===nowPage&&myApp.alert(stringObj.text.nowCoin+"："+n.gpmr_point,stringObj.text.warn),indexObj._dataStorage(indexObj._storage.favorite,o),0===o.newsList.length){var a=indexObj.template("templateFavoriteListNull")("");$$(".news").html(a)}if(0===o.couponList.length){var r=indexObj.template("templateFavoriteListNull")("");$$(".couponList").html(r)}if(0===o.branchList.length){var s=indexObj.template("templateFavoriteListNull")("");$$(".branchList").html(s)}if(0===o.shopcouponList.length){var c=indexObj.template("templateFavoriteListNull")("");$$(".shopcouponList").html(c)}}else stringObj.return_header(n.message_no),_tip&&(myApp.alert(_tip+"( "+n.message_no+" )",stringObj.text.warn),_tip=null);myApp.hideIndicator()}},error:function(e){myApp.hideIndicator(),noNetwork()}})})},favoriteType=function(e){fType=e};var myApp=new Framework7({swipeBackPage:!1,pushState:!0,pushStateNoAnimation:!0,swipePanel:"left",swipePanelActiveArea:-1,imagesLazyLoadPlaceholder:"../app/image/imgDefault.png",imagesLazyLoadThreshold:150,animatePages:!1,materialRipple:!1,modalButtonOk:stringObj.text.confirm,modalButtonCancel:stringObj.text.cancel}),swiper=new Swiper(".ad-block",{nextButton:".swiper-button-next",prevButton:".swiper-button-prev",centeredSlides:!0,autoplay:1500,autoplayDisableOnInteraction:!1,loop:!0}),$$=Dom7,mainView=myApp.addView(".view-main",{dynamicNavbar:!0});$(document).ready(function(){indexObj.query_salt(stringObj.shop.moduleaccount,stringObj.shop.modulepassword),$$(document).on("open",".modal",function(e){$(this).find("h1#cdd-qrcode").length&&$(this).css("top","150px")})}),$$(".panel-left").on("open",function(){$$(".left a").html('<i class="fa fa-angle-double-left"></i>'),"branch-info"==nowPage&&"1"===indexObj._dataCookies(indexObj._storage.main).md_clienttype&&$(".back-btn a").html('<i class="fa fa-angle-double-left"></i>')}),$$(".panel-left").on("close",function(){$$(".left a").html('<span class="kkicon icon-menu"></span>'),"branch-info"==nowPage&&"1"===indexObj._dataCookies(indexObj._storage.main).md_clienttype&&$(".back-btn a").html('<span class="kkicon icon-menu"></span>')}),$$(document).on("open",".modal",function(e){$(".view").css("-webkit-filter","blur(5px)")}),$$(document).on("close",".modal",function(e){$(".view").css("-webkit-filter","blur(0px)")}),$$(".shop-menu").on("open",function(){var e=indexObj._dataCookies(indexObj._storage.main)||{};"1"===e.md_clienttype?stringObj.shop.isShop=!0:"100"==e.md_clienttype?stringObj.shop.isBusiness=!0:stringObj.shop.isShop=!1,e.sat&&(stringObj.shop.signed_in=!0);var t=indexObj.template("templateShopMenu")(stringObj.shop);$$(".contentBlock").html(t),$(".shop_list").click(function(){window.location="pm/branch-cooperative"}),$(".shop-menu a").click(function(){myApp.closeModal(".shop-menu")})});var mySwiper,toast=myApp.toast("message",'<i class="fa fa-exclamation-triangle"></i>',{});$.fn.serializeObject=function(){var e={},t=this.serializeArray();return $.each(t,function(){void 0!==e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),e},jQuery.extend(jQuery.validator.defaults,{errorPlacement:function(e,t){t.is(":radio")||t.is(":checkbox")?t.parents(".form-row").append(e):e.insertAfter(t)}}),jQuery.extend(jQuery.validator.messages,{required:stringObj.text.required,email:stringObj.text.emailFormatError}),jQuery.validator.addMethod("phoneonly",function(e,t){return this.optional(t)||/^[\d\-\+\#*]+$/i.test(e)},stringObj.text.telFormatError),jQuery.validator.addMethod("usualword",function(e,t){return this.optional(t)||!/[`~,.<>;':"\/\[\]\|{}()=_+-]/.test(e)},stringObj.text.textFormatError),Date.prototype.yyyymmdd=function(){var e=this.getFullYear().toString(),t=(this.getMonth()+1).toString(),o=this.getDate().toString();return e+"/"+(t[1]?t:"0"+t[0])+"/"+(o[1]?o:"0"+o[0])},Date.prototype.yyyymmddhhmmss=function(){var e=this.getHours().toString(),t=this.getMinutes().toString(),o=this.getSeconds().toString();return this.yyyymmdd()+" "+(e[1]?e:"0"+e[0])+":"+(t[1]?t:"0"+t[0])+":"+(o[1]?o:"0"+o[0])},toWeb=function(e){isMobile.Android()?Android.toWeb(e):isMobile.iOS()&&iPhone.toWeb(e)},dataNull=function(e,t,o){var i={text:t},n=indexObj.template(e)(i);$$(o).html(n)},logout=function(){myApp.modal({title:stringObj.text.warn,text:stringObj.text.logoutCheck,buttons:[{text:stringObj.text.cancel,onClick:function(){}},{text:stringObj.text.confirm,onClick:function(){indexObj._userLogout()}}]})},loginStatus=function(e){if((indexObj._dataCookies(indexObj._storage.main)||{}).mdId)switch(e){case"activity_preferential":break;case"bonus_record":mainView.router.load({url:"shop/bonus-record",reload:!0});break;case"shop_favorite":mainView.router.load({url:"shop/favorite",reload:!0});break;case"coupon_record":mainView.router.load({url:"coupon-record",reload:!0});break;case"open_store":var t=indexObj._dataStorage(branchObj.storage.applicationData)||"";t?(myApp.modal({title:stringObj.text.application_data_record,text:'<div class="row"><div class="col-28">店名：</div><div class="col-72">'+t.sd_shopname+'</div></div><div class="row"><div class="col-28">狀態：</div><div class="col-72">'+stringObj.text.not_finish+"</div></div>",buttons:[{text:stringObj.text._delete,onClick:function(){indexObj._dataStorage(branchObj.storage.applicationData,null)}},{text:stringObj.text._continue,onClick:function(){"0"==t.operation_type?mainView.router.load({url:"application-shop",reload:!0}):"1"==t.operation_type&&mainView.router.load({url:"application-usedcar",reload:!0})}}]}),$(".modal-title + .modal-text").css("text-align","left"),$(".modal-title + .modal-text").css("margin","5% 3%"),$(".modal-title + .modal-text .row").css("margin","3% 0"),$(".modal-title + .modal-text .row .col-28").css("width","28%"),$(".modal-title + .modal-text .row .col-28").css("color","darkslategray"),$(".modal-title + .modal-text .row .col-72").css("width","72%")):mainView.router.load({url:"application-shop"})}else myApp.modal({title:stringObj.text.warn,text:stringObj.text.notLogin,buttons:[{text:stringObj.text.cancel,onClick:function(){}},{text:stringObj.text.login,onClick:function(){localStorage.setItem("from","Shop"),webview.loginPage()}}]})},loginCheck=function(e,t,o){var i=indexObj._dataCookies(indexObj._storage.main)||{};if("0"===i.loginType||"3"===i.loginType)switch(nowPage){case"coupon-record":"shop_available"==t||"shop_finish"==t||"shop_invalid"==t||"reserved"==t?window.location="pm/shopcoupon-info?scm_id="+e+"&type="+t+"&scg_id="+o:"service_available"!=t&&"service_finish"!=t&&"service_invalid"!=t||mainView.router.load({url:"shop/shopservice-info?ssqd_id="+e+"&type="+t+"&ssqq_id="+o});break;case"favorite":mainView.router.load({url:"favorite-coupon-content?cdmId="+e+"&type="+t+"&cdd_qr="+o})}else myApp.modal({title:stringObj.text.warn,text:stringObj.text.notLogin,buttons:[{text:stringObj.text.cancel,onClick:function(){}},{text:stringObj.text.login,onClick:function(){webview.loginPage()}}]})},code39=function(e){" "!=e&&("server-main"==nowPage&&isMobile.Android(),myApp.modal({title:"",text:'<div class="member-block"><div class="code39-title">'+stringObj.text.code39_title+'</div><br><div class="barcode39" style="width:200px; height:80px; margin: 0% auto;">'+e+"</div><p>"+e+"</p></div>",buttons:[{text:stringObj.text.confirm,bold:!0}]}),$(".barcode39").barcode({code:"code39"}))},setParameter=function(e){if("tw"===_region)t={mur:e,modacc:stringObj.shop.moduleaccount,modvrf:CryptoJS.SHA256(stringObj.shop.moduleaccount+stringObj.shop.modulepassword).toString(),redirect_uri:"http://"+stringObj.WEB_URL+"/pm-transform"};else var t={mur:e,modacc:_region+"_"+stringObj.shop.moduleaccount,modvrf:CryptoJS.SHA256(_region+"_"+stringObj.shop.moduleaccount+stringObj.shop.modulepassword).toString(),redirect_uri:"http://"+stringObj.WEB_URL+"/pm-transform"};Cookies.set("parameter",encodeURIComponent(btoa(JSON.stringify(t))))},toTop=function(){var e,t=0;$$(".to-top").hide(),$$(".infinite-scroll").on("scroll",function(o){var i=this;clearTimeout(e),e=setTimeout(function(){var e=$$(i).scrollTop();e>200&&(e>t?(t=e,$$(".to-top").hide()):(t-e>200&&($(".to-top").show(),setTimeout(function(){$$(".to-top").hide()},3e3)),t=e))},200)}),$$(".to-top").click(function(e){t=0,$$(this).hide(),$$(this).parent(".page").children(".infinite-scroll").scrollTop(0,500)})},noGpsModal=function(){myApp.modal({title:stringObj.text.warn,text:stringObj.shop.no_GPS,verticalButtons:!0,buttons:[{text:stringObj.text.setting,onClick:function(){webview.openSettingGPS()}},{text:stringObj.text.default_GPS,onClick:function(){if("map"===nowPage||"map"===nowMode){full_map.setCenter(new google.maps.LatLng(stringObj.text.default_lat,stringObj.text.default_lng)),Cookies.set("sd_lat",stringObj.text.default_lat),Cookies.set("sd_lng",stringObj.text.default_lng);for(var e=0;e<markers.length;e++)markers[e].setMap(null);markers=[],branchObj.branchListGet(""),"map"===nowPage&&$(".search-btn").css("display","none"),my_marker&&my_marker.setMap(null);var t={url:"app/image/user-marker.png"};my_marker=new google.maps.Marker({position:new google.maps.LatLng(nowlat,nowlng),map:full_map,title:"Me",icon:t})}if("branch-cooperative"===nowPage){nowlat=stringObj.text.default_lat,nowlng=stringObj.text.default_lng;var o={};o.spm_serno=2,o.sd_lat=stringObj.text.default_lat,o.sd_lng=stringObj.text.default_lng,o.sd_shopname="",o.sd_country="",indexObj._dataStorage(indexObj._storage.search_result,o),mainView.router.load({url:"around-search-result"})}}},{text:stringObj.text.cancel,onClick:function(){}}]})},memberseccode=function(e,t){myApp.popup(".memberseccode");var o=[];switch($(".seccode-block .col-16").html(""),$(".num-block .col-33.num").unbind("click"),$(".num-block .col-33.num").click(function(e){if(o.length<6){o.push($(this).text());for(var t in o)$(".seccode-block .col-16").eq(t).html("·")}}),$(".num-block .col-33.del").unbind("click"),$(".num-block .col-33.del").click(function(e){if(o.length>0){o.splice(o.length-1,1),$(".seccode-block .col-16").html("");for(var t in o)$(".seccode-block .col-16").eq(t).html("·")}}),$(".num-block .close-popup").unbind("click"),$(".num-block .close-popup").click(function(e){o=[],$(".seccode-block .col-16").html("")}),$$(".memberseccode").on("popup:opened",function(i,n){switch(e){case"set":$(".memberseccode .title").html(stringObj.text.set_memberseccode),$(".memberseccode .confirm a").html(stringObj.text._set),$(".memberseccode .confirm").unbind("click"),$(".memberseccode .confirm").click(function(e){6===o.length&&indexObj.modify_memberseccode("",CryptoJS.SHA256(o.join("")).toString())});break;case"old":$(".memberseccode .title").html(stringObj.text.input_old_memberseccode),$(".memberseccode .confirm a").html(stringObj.text.next),$(".memberseccode .confirm").unbind("click"),$(".memberseccode .confirm").click(function(e){6===o.length&&(myApp.closeModal(".memberseccode"),memberseccode("new",CryptoJS.SHA256(o.join("")).toString()))});break;case"new":$(".memberseccode .title").html(stringObj.text.input_new_memberseccode),$(".memberseccode .confirm a").html(stringObj.text.edit),$(".memberseccode .confirm").unbind("click"),$(".memberseccode .confirm").click(function(e){6===o.length&&t!==CryptoJS.SHA256(o.join("")).toString()?indexObj.modify_memberseccode(t,CryptoJS.SHA256(o.join("")).toString()):6===o.length&&t===CryptoJS.SHA256(o.join("")).toString()&&myApp.alert(stringObj.text.memberseccode_same,stringObj.text.warn)});break;default:$(".memberseccode .title").html(stringObj.text.input_memberseccode),$(".memberseccode .confirm a").html(stringObj.text.confirm),$(".memberseccode .confirm").unbind("click"),$(".memberseccode .confirm").click(function(e){6===o.length&&indexObj.verify_memberseccode(CryptoJS.SHA256(o.join("")).toString())})}}),e){case"set":$(".memberseccode .title").html(stringObj.text.set_memberseccode),$(".memberseccode .confirm a").html(stringObj.text._set),$(".memberseccode .confirm").unbind("click"),$(".memberseccode .confirm").click(function(e){6===o.length&&indexObj.modify_memberseccode("",CryptoJS.SHA256(o.join("")).toString())});break;case"old":$(".memberseccode .title").html(stringObj.text.input_old_memberseccode),$(".memberseccode .confirm a").html(stringObj.text.next),$(".memberseccode .confirm").unbind("click"),$(".memberseccode .confirm").click(function(e){6===o.length&&(myApp.closeModal(".memberseccode"),memberseccode("new",CryptoJS.SHA256(o.join("")).toString()))});break;case"new":$(".memberseccode .title").html(stringObj.text.input_new_memberseccode),$(".memberseccode .confirm a").html(stringObj.text.edit),$(".memberseccode .confirm").unbind("click"),$(".memberseccode .confirm").click(function(e){6===o.length&&t!==CryptoJS.SHA256(o.join("")).toString()?indexObj.modify_memberseccode(t,CryptoJS.SHA256(o.join("")).toString()):6===o.length&&t===CryptoJS.SHA256(o.join("")).toString()&&myApp.alert(stringObj.text.memberseccode_same,stringObj.text.warn)});break;default:$(".memberseccode .title").html(stringObj.text.input_memberseccode),$(".memberseccode .confirm a").html(stringObj.text.confirm),$(".memberseccode .confirm").unbind("click"),$(".memberseccode .confirm").click(function(e){6===o.length&&indexObj.verify_memberseccode(CryptoJS.SHA256(o.join("")).toString())})}};